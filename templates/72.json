{
    "category": "funding_based",
    "question": "Which {state_var} has the {stat_method_1} NCAP funding with respect to {stat_method_2} {num_col} concentration in 2021 (FY 2020-21)?",
    "code": "def true_code():\n    import pandas as pd\n    main_data = pd.read_pickle(\"preprocessed/main_data.pkl\")\n    states_data = pd.read_pickle(\"preprocessed/states_data.pkl\")\n    ncap_funding_data = pd.read_pickle(\"preprocessed/ncap_funding_data.pkl\")\n    data_year = main_data[main_data['Timestamp'].dt.year == 2021]\n    city_pm_year = data_year.groupby('{state_code}')['{col}'].{method_2}.reset_index()\n    funding_year = ncap_funding_data[['{state_code}', 'Amount released during FY 2020-21']]\n    merged_df = city_pm_year.merge(funding_year, on='{state_code}', how='inner')\n    merged_df['funding_per_pm'] = merged_df['Amount released during FY 2020-21'] / merged_df['{col}']\n    lowest_funding_city = merged_df.sort_values('funding_per_pm').iloc[{method_1}]['{state_code}']\n    print(lowest_funding_city)\ntrue_code()",
    "ques_vars": [
        "stat_method_1",
        "stat_method_2",
        "state_var",
        "num_col"
    ],
    "code_vars": [
        "method_1",
        "method_2",
        "state_code",
        "col"
    ],
    "stat_method_1": [
        "lowest",
        "highest",
        "2nd lowest",
        "2nd highest",
        "3rd lowest",
        "3rd highest",
        "4th lowest",
        "4th highest",
        "5th lowest",
        "5th highest"
    ],
    "stat_method_2": [
        "average",
        "median",
        "total",
        "standard deviation of",
        "variance of",
        "25th percentile of",
        "75th percentile of"
    ],
    "state_var": [
        "state",
        "city"
    ],
    "num_col": [
        "PM 2.5",
        "PM 10"
    ],
    "method_1": [
        "0",
        "len(merged_df)-1",
        "1",
        "len(merged_df)-2",
        "2",
        "len(merged_df)-3",
        "3",
        "len(merged_df)-4",
        "4",
        "len(merged_df)-5"
    ],
    "method_2": [
        "mean()",
        "median()",
        "sum()",
        "std()",
        "var()",
        "quantile(0.25)",
        "quantile(0.75)"
    ],
    "state_code": [
        "state",
        "city"
    ],
    "col": [
        "PM2.5",
        "PM10"
    ]
}