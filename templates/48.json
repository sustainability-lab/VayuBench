{
    "category": "population_based",
    "question": "Which union territory was the {stat_method_1} polluted in terms of per capita {num_col} exposure in {year}?",
    "code": "\ndef true_code():\n    import pandas as pd\n    main_data = pd.read_pickle(\"preprocessed/main_data.pkl\")\n    states_data = pd.read_pickle(\"preprocessed/states_data.pkl\")\n    ncap_funding_data = pd.read_pickle(\"preprocessed/ncap_funding_data.pkl\")\n\n\n    data_year = main_data[main_data['Timestamp'].dt.year == {code_year}]\n    state_pm_avg = data_year.groupby('state')['{col}'].mean().reset_index()\n    filtered_states_data = states_data[states_data['isUnionTerritory'] == True][['state', 'population']]\n    merged_df = state_pm_avg.merge(filtered_states_data, on='state',how='inner')\n    merged_df['per_capita_pm'] = (merged_df['{col}'] / merged_df['population']) * 1000000  \n    required_state = merged_df.sort_values('per_capita_pm').iloc[{method_1}]['state']\n    print(required_state)\n\n\ntrue_code()\n",
    "ques_vars": [
        "stat_method_1",
        "num_col",
        "year"
    ],
    "code_vars": [
        "method_1",
        "col",
        "code_year"
    ],
    "stat_method_1": [
        "lowest",
        "highest",
        "2nd lowest",
        "2nd highest",
        "3rd lowest",
        "3rd highest"
    ],
    "num_col": [
        "PM 2.5",
        "PM 10"
    ],
    "year": [
        "2018",
        "2019",
        "2020",
        "2021",
        "2022",
        "2023",
        "2024"
    ],
    "method_1": [
        "0",
        "len(merged_df)-1",
        "1",
        "len(merged_df)-2",
        "2",
        "len(merged_df)-3"
    ],
    "col": [
        "PM2.5",
        "PM10"
    ],
    "code_year": [
        "2018",
        "2019",
        "2020",
        "2021",
        "2022",
        "2023",
        "2024"
    ]
}