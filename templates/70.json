{
    "category": "funding_based",
    "question": "Which {state_var} with NCAP funding has the {stat_method_1} {num_col} levels?",
    "code": "\ndef true_code():\n    import pandas as pd\n    main_data = pd.read_pickle(\"preprocessed/main_data.pkl\")\n    states_data = pd.read_pickle(\"preprocessed/states_data.pkl\")\n    ncap_funding_data = pd.read_pickle(\"preprocessed/ncap_funding_data.pkl\")\n\n    state_pm25_avg = main_data.groupby('{state_code}')['{col}'].mean().reset_index()\n    funded_states = ncap_funding_data[ncap_funding_data['Total fund released'] > 0]['{state_code}'].unique()\n    funded_pm_states = state_pm25_avg[state_pm25_avg['{state_code}'].isin(funded_states)]\n    ans = funded_pm_states.sort_values('{col}').iloc[{method_1}]['{state_code}']\n    print(ans)\n\ntrue_code()\n",
    "ques_vars": [
        "stat_method_1",
        "state_var",
        "num_col"
    ],
    "code_vars": [
        "method_1",
        "state_code",
        "col"
    ],
    "stat_method_1": [
        "lowest",
        "highest",
        "2nd lowest",
        "2nd highest",
        "3rd lowest",
        "3rd highest",
        "4th lowest",
        "4th highest",
        "5th lowest",
        "5th highest"
    ],
    "state_var": [
        "state",
        "city"
    ],
    "num_col": [
        "PM 2.5",
        "PM 10"
    ],
    "method_1": [
        "0",
        "len(funded_pm_states)-1",
        "1",
        "len(funded_pm_states)-2",
        "2",
        "len(funded_pm_states)-3",
        "3",
        "len(funded_pm_states)-4",
        "4",
        "len(funded_pm_states)-5"
    ],
    "state_code": [
        "state",
        "city"
    ],
    "col": [
        "PM2.5",
        "PM10"
    ]
}