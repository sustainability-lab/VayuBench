{
    "category": "population_based",
    "question": "Among states with a population {below} the {stat_method_2} population, which one receives the {stat_method_1} per capita NCAP funding?",
    "code": "\ndef true_code():\n    import pandas as pd\n    main_data = pd.read_pickle(\"preprocessed/main_data.pkl\")\n    states_data = pd.read_pickle(\"preprocessed/states_data.pkl\")\n    ncap_funding_data = pd.read_pickle(\"preprocessed/ncap_funding_data.pkl\")\n\n\n    state_funding = ncap_funding_data.groupby('state')['Total fund released'].sum().reset_index()\n    merged_df = pd.merge(states_data, state_funding, on='state')\n    merged_df['funding_per_capita'] = merged_df['Total fund released'] / merged_df['population']\n    required_pop = states_data['population'].{method_2}\n    merged_df = merged_df[merged_df['population'] {code_below} required_pop]\n    required_state = merged_df.sort_values('funding_per_capita').iloc[{method_1}]['state']\n    print(required_state)\n\ntrue_code()\n",
    "ques_vars": [
        "stat_method_1",
        "stat_method_2",
        "below"
    ],
    "code_vars": [
        "method_1",
        "method_2",
        "code_below"
    ],
    "stat_method_1": [
        "lowest",
        "highest",
        "2nd lowest",
        "2nd highest",
        "3rd lowest",
        "3rd highest"
    ],
    "stat_method_2": [
        "average",
        "median",
        "25th percentile",
        "75th percentile"
    ],
    "below": [
        "below",
        "above"
    ],
    "method_1": [
        "0",
        "len(merged_df)-1",
        "1",
        "len(merged_df)-2",
        "2",
        "len(merged_df)-3"
    ],
    "method_2": [
        "mean()",
        "median()",
        "quantile(0.25)",
        "quantile(0.75)"
    ],
    "code_below": [
        "<",
        ">"
    ]
}